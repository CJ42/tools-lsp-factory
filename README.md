# lsp-factory.js

> **âš  WARNING: WIP **  

Helper Library to allow simple deployments of LSP3UniversalProfiles and LSP4DigitalCertificates

# Install 

```bash
npm install  @lukso/lsp-factory.js
```

# Setup

```javascript
import { LSPFactory } from "@lukso/lsp-factory.js";

  const signer = '0x...' // Private key of the controlling account
  const provider = "https://rpc.l14.lukso.network"

  const lspFactory = new LSPFactory(signer, provider);
```
# Usage

### Deploying an LSP3 Account

```javascript
// Deploy LSP3 Account
const myContracts = await lspFactory.LSP3UniversalProfile.deploy({
    controllerAddresses: [web3.eth.accounts.wallet[0].address],
    lsp3Profile: {
      json: {
        LSP3Profile: {
          name: "My Universal Profile",
          description: "My cool Universal Profile",
          profileImage: [
            {
              width: 500,
              height: 500,
              hashFunction: "keccak256(bytes)",
              hash: "0x...", // bytes32 hex string of the image hash
              url: "ipfs://QmPLqMFHxiUgYAom3Zg4SiwoxDaFcZpHXpCmiDzxrtjSGp",
            },
          ],
          backgroundImage: [
            {
              width: 500,
              height: 500,
              hashFunction: "keccak256(bytes)",
              hash: "0x...", // bytes32 hex string of the image hash
              url: "ipfs://QmPLqMFHxiUgYAom3Zg4SiwoxDaFcZpHXpCmiDzxrtjSGp",
            },
          ],
          tags: ['Fashion', 'Design'],
          links: ['www.my-website.com'],
        },
      },
      url: "",
    },
  });
};

const myUPAddress = myContracts.erc725Account.address;
```

### Using Deployment events 

The `deployReactive` method can be used to for real-time frontend updates.

```javascript
const profileDeploymentEvents = [];

const myUPAccount = await lspFactory.LSP3UniversalProfile.deployReactive({
    ...
}).subscribe({
  next: (deploymentEvent: DeploymentEvent) => {
    profileDeploymentEvents.push(deploymentEvent);
  },
  error: (error) => {
    console.error(error);
  },
  complete: () => {
    console.log(profileDeploymentEvents);
  },
});
```
# Types / Typechain

To update the types generated by [Typechain](https://github.com/ethereum-ts/TypeChain) run the following `npm` command.

```bash
npm run generate-types
```

In the [package.json](package.json) file under `scripts` there is a `post-install` hook, which also runs `generate-types` every time you install a package.
